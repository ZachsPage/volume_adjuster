#include "MyBluetooth.h"

using namespace MyStuff;

////////////////////////////////////////////////////////////////////////////////
//! Static Inits
constexpr esp_bt_pin_code_t MyBTHelpers::kMyPin;
constexpr char MyBTHelpers::kDevName[11];
constexpr esp_spp_mode_t MyBTHelpers::kEspSppMode;
constexpr esp_spp_sec_t MyBTHelpers::kSecMask;
constexpr esp_spp_role_t MyBTHelpers::kRole;

////////////////////////////////////////////////////////////////////////////////
char* MyBTHelpers::uuid2str(esp_bt_uuid_t *uuid, char *str, size_t size)
{
    if (uuid == NULL || str == NULL) {
        return NULL;
    }

    if (uuid->len == 2 && size >= 5) {
        sprintf(str, "%04x", uuid->uuid.uuid16);
    } else if (uuid->len == 4 && size >= 9) {
        sprintf(str, "%08x", uuid->uuid.uuid32);
    } else if (uuid->len == 16 && size >= 37) {
        uint8_t *p = uuid->uuid.uuid128;
        sprintf(str, "%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x",
                p[15], p[14], p[13], p[12], p[11], p[10], p[9], p[8],
                p[7], p[6], p[5], p[4], p[3], p[2], p[1], p[0]);
    } else {
        return NULL;
    }

    return str;
}
////////////////////////////////////////////////////////////////////////////////
char* MyBTHelpers::bda2str(esp_bd_addr_t bda, char *str, size_t size)
{
    if (bda == NULL || str == NULL || size < 18) {
        return NULL;
    }

    uint8_t *p = bda;
    sprintf(str, "%02x:%02x:%02x:%02x:%02x:%02x",
            p[0], p[1], p[2], p[3], p[4], p[5]);
    return str;
}
